!function(){var t={version:"0.1.0"};t._support={},t._support.toColorObj=function(t){var r={};return r.r=t[0],r.g=t[1],r.b=t[2],r},t._support.CanvasImage=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)},t._support.CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},t._support.CanvasImage.prototype.update=function(t){this.context.putImageData(t,0,0)},t._support.CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},t._support.CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},t._support.CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)},t.algorithms={},t.algorithms.quantize=function(t,r){if(!o)var o={map:function(t,r){var o={};return r?t.map(function(t,n){return o.index=n,r.call(o,t)}):t.slice()},naturalOrder:function(t,r){return r>t?-1:t>r?1:0},sum:function(t,r){var o={};return t.reduce(r?function(t,n,e){return o.index=e,t+r.call(o,n)}:function(t,r){return t+r},0)},max:function(t,r){return Math.max.apply(null,r?o.map(t,r):t)}};var n=function(){function t(t,r,o){return(t<<2*c)+(r<<c)+o}function r(t){function r(){o.sort(t),n=!0}var o=[],n=!1;return{push:function(t){o.push(t),n=!1},peek:function(t){return n||r(),void 0===t&&(t=o.length-1),o[t]},pop:function(){return n||r(),o.pop()},size:function(){return o.length},map:function(t){return o.map(t)},debug:function(){return n||r(),o}}}function n(t,r,o,n,e,i,a){var u=this;u.r1=t,u.r2=r,u.g1=o,u.g2=n,u.b1=e,u.b2=i,u.histo=a}function e(){this.vboxes=new r(function(t,r){return o.naturalOrder(t.vbox.count()*t.vbox.volume(),r.vbox.count()*r.vbox.volume())})}function i(r){var o,n,e,i,a=1<<3*c,u=new Array(a);return r.forEach(function(r){n=r[0]>>f,e=r[1]>>f,i=r[2]>>f,o=t(n,e,i),u[o]=(u[o]||0)+1}),u}function a(t,r){var o,e,i,a=1e6,u=0,s=1e6,c=0,v=1e6,p=0;return t.forEach(function(t){o=t[0]>>f,e=t[1]>>f,i=t[2]>>f,a>o?a=o:o>u&&(u=o),s>e?s=e:e>c&&(c=e),v>i?v=i:i>p&&(p=i)}),new n(a,u,s,c,v,p,r)}function u(r,n){function e(t){var r,o,e,i,a,u=t+"1",s=t+"2",f=0;for(c=n[u];c<=n[s];c++)if(l[c]>h/2){for(e=n.copy(),i=n.copy(),r=c-n[u],o=n[s]-c,a=o>=r?Math.min(n[s]-1,~~(c+o/2)):Math.max(n[u],~~(c-1-r/2));!l[a];)a++;for(f=d[a];!f&&l[a-1];)f=d[--a];return e[s]=a,i[u]=e[s]+1,[e,i]}}if(n.count()){var i=n.r2-n.r1+1,a=n.g2-n.g1+1,u=n.b2-n.b1+1,s=o.max([i,a,u]);if(1==n.count())return[n.copy()];var c,f,v,p,g,h=0,l=[],d=[];if(s==i)for(c=n.r1;c<=n.r2;c++){for(p=0,f=n.g1;f<=n.g2;f++)for(v=n.b1;v<=n.b2;v++)g=t(c,f,v),p+=r[g]||0;h+=p,l[c]=h}else if(s==a)for(c=n.g1;c<=n.g2;c++){for(p=0,f=n.r1;f<=n.r2;f++)for(v=n.b1;v<=n.b2;v++)g=t(f,c,v),p+=r[g]||0;h+=p,l[c]=h}else for(c=n.b1;c<=n.b2;c++){for(p=0,f=n.r1;f<=n.r2;f++)for(v=n.g1;v<=n.g2;v++)g=t(f,v,c),p+=r[g]||0;h+=p,l[c]=h}return l.forEach(function(t,r){d[r]=h-t}),e(s==i?"r":s==a?"g":"b")}}function s(t,n){function s(t,r){for(var o,n=1,e=0;v>e;)if(o=t.pop(),o.count()){var i=u(c,o),a=i[0],s=i[1];if(!a)return;if(t.push(a),s&&(t.push(s),n++),n>=r)return;if(e++>v)return}else t.push(o),e++}if(!t.length||2>n||n>256)return!1;var c=i(t),f=0;c.forEach(function(){f++});var g=a(t,c),h=new r(function(t,r){return o.naturalOrder(t.count(),r.count())});h.push(g),s(h,p*n);for(var l=new r(function(t,r){return o.naturalOrder(t.count()*t.volume(),r.count()*r.volume())});h.size();)l.push(h.pop());s(l,n-l.size());for(var d=new e;l.size();)d.push(l.pop());return d}var c=5,f=8-c,v=1e3,p=.75;return n.prototype={volume:function(t){var r=this;return(!r._volume||t)&&(r._volume=(r.r2-r.r1+1)*(r.g2-r.g1+1)*(r.b2-r.b1+1)),r._volume},count:function(r){var o=this,n=o.histo;if(!o._count_set||r){var e,i,a,u=0;for(e=o.r1;e<=o.r2;e++)for(i=o.g1;i<=o.g2;i++)for(a=o.b1;a<=o.b2;a++)index=t(e,i,a),u+=n[index]||0;o._count=u,o._count_set=!0}return o._count},copy:function(){var t=this;return new n(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(r){var o=this,n=o.histo;if(!o._avg||r){var e,i,a,u,s,f=0,v=1<<8-c,p=0,g=0,h=0;for(i=o.r1;i<=o.r2;i++)for(a=o.g1;a<=o.g2;a++)for(u=o.b1;u<=o.b2;u++)s=t(i,a,u),e=n[s]||0,f+=e,p+=e*(i+.5)*v,g+=e*(a+.5)*v,h+=e*(u+.5)*v;o._avg=f?[~~(p/f),~~(g/f),~~(h/f)]:[~~(v*(o.r1+o.r2+1)/2),~~(v*(o.g1+o.g2+1)/2),~~(v*(o.b1+o.b2+1)/2)]}return o._avg},contains:function(t){var r=this,o=t[0]>>f;return gval=t[1]>>f,bval=t[2]>>f,o>=r.r1&&o<=r.r2&&gval>=r.g1&&gval<=r.g2&&bval>=r.b1&&bval<=r.b2}},e.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var r=this.vboxes,o=0;o<r.size();o++)if(r.peek(o).vbox.contains(t))return r.peek(o).color;return this.nearest(t)},nearest:function(t){for(var r,o,n,e=this.vboxes,i=0;i<e.size();i++)o=Math.sqrt(Math.pow(t[0]-e.peek(i).color[0],2)+Math.pow(t[1]-e.peek(i).color[1],2)+Math.pow(t[2]-e.peek(i).color[2],2)),(r>o||void 0===r)&&(r=o,n=e.peek(i).color);return n},forcebw:function(){var t=this.vboxes;t.sort(function(t,r){return o.naturalOrder(o.sum(t.color),o.sum(r.color))});var r=t[0].color;r[0]<5&&r[1]<5&&r[2]<5&&(t[0].color=[0,0,0]);var n=t.length-1,e=t[n].color;e[0]>251&&e[1]>251&&e[2]>251&&(t[n].color=[255,255,255])}},{quantize:s}}();return n.quantize(t,r)},t.video=function(r){function o(){var t=765,r=7,o=t/r;return{MAX_BRIGHTNESS:765,VERY_DARK:1*o,DARK:2*o,BRIGHT:3*o,VERY_BRIGHT:4*o}}var n=this;return n.origin=r,n.color={},n.color.colorPalette=function(o,n){"undefined"==typeof o&&(o=10),"undefined"==typeof n&&(n=10);for(var e,i,a,u,s,c=new t._support.CanvasImage(r),f=c.getImageData(),v=f.data,p=c.getPixelCount(),g=[],h=0;p>h;h+=n)e=4*h,i=v[e+0],a=v[e+1],u=v[e+2],s=v[e+3],s>=125&&(i>250&&a>250&&u>250||g.push([i,a,u]));var l=t.algorithms.quantize(g,o),d=l.palette();return c.removeCanvas(),d},n.color.dominantColor=function(t){var r=n.color.colorPalette(5,t),o=r[0];return o},n.isVeryDark=function(){var e=o(),i=n.color.dominantColor(r);i=t._support.toColorObj(i);var a=i.r+i.g+i.b;return a<=e.VERY_DARK?!0:!1},n.isDark=function(){var e=o(),i=n.color.dominantColor(r);i=t._support.toColorObj(i);var a=i.r+i.g+i.b;return a>e.VERY_DARK&&a<=e.DARK?!0:!1},n.isBright=function(){var e=o(),i=n.color.dominantColor(r);i=t._support.toColorObj(i);var a=i.r+i.g+i.b;return a>=e.DARK&&a<e.BRIGHT?!0:!1},n.isVeryBright=function(){var e=o(),i=n.color.dominantColor(r);i=t._support.toColorObj(i);var a=i.r+i.g+i.b;return a>=e.BRIGHT?!0:!1},n.getBrightness=function(){var e=o(),i=n.color.dominantColor(r,5);i=t._support.toColorObj(i);var a=i.r+i.g+i.b;return a/e.MAX_BRIGHTNESS},n.getPixels=function(){var o=new t._support.CanvasImage(r),n=o.getImageData(),e=n.data;return o.removeCanvas(),e},n.getPixelCount=function(){var o=new t._support.CanvasImage(r);return o.removeCanvas(),o.getPixelCount()},n.getPermission=function(){var t=function(){return!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)};if(!t())throw new Error("getPermission(): Sorry, your browser does not support this behaviour");var o={video:!0};return new Promise(function(t,n){navigator.getUserMedia?navigator.getUserMedia(o,function(o){r.src=o,r.play(),window.setTimeout(function(){t(r)},1e3)},n):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(o,function(o){r.src=window.webkitURL.createObjectURL(o),r.play(),window.setTimeout(function(){t(r)},1e3)},n):navigator.mozGetUserMedia&&navigator.mozGetUserMedia(o,function(o){r.src=window.URL.createObjectURL(o),r.play(),window.setTimeout(function(){t(r)},1e3)},n)})},n===t?new t.video(r):void 0},t.detect={},t.detect.usingFirefox=function(){return new Promise(function(t){var r,o=document.createElement("img");o.addEventListener("load",function(){t(r=!0)},!1),o.addEventListener("error",function(){t(r=!1)},!1),o.setAttribute("src","about:logo")})},"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports&&(module.exports=t),this.oo=t}();